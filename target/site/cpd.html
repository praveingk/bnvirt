<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.3 at 2 Aug, 2017 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=${outputEncoding}" />
    <title>CPD Results</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20170802" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
            
                <div class="xleft">
        <span id="publishDate">Last Published: 2017-08-02</span>
                  &nbsp;| <span id="projectVersion">Version: ${project.version}</span>
                      </div>
            <div class="xright">        
            
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
            
                                      <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
            
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>CPD Results<a name="CPD_Results"></a></h2><p>The following document contains the results of PMD's  <a class="externalLink" href="http://pmd.sourceforge.net/cpd.html">CPD</a> 5.0.5.</p></div><div class="section"><h2>Duplications<a name="Duplications"></a></h2><table align="center" border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/tenant/StartOVXPort.java</td><td>70</td></tr><tr class="a"><td>net/onrc/openvirtex/api/service/handlers/tenant/StopOVXPort.java</td><td>70</td></tr><tr class="b"><td colspan='2'><div><pre>                    &quot;Start virtual port {} on virtual switch {} in virtual network {}&quot;,
                    port, dpid, virtualNetwork.getTenantId());
            OVXPort ovxPort = virtualNetwork.getSwitch(dpid.longValue())
                    .getPort(port.shortValue());
            Map&lt;String, Object&gt; reply = new HashMap&lt;String, Object&gt;(
                    ovxPort.getDBObject());
            reply.put(TenantHandler.VDPID, ovxPort.getParentSwitch()
                    .getSwitchId());
            reply.put(TenantHandler.TENANT, ovxPort.getTenantId());
            resp = new JSONRPC2Response(reply, 0);

        } catch (final MissingRequiredField e) {
            resp = new JSONRPC2Response(
                    new JSONRPC2Error(
                            JSONRPC2Error.INVALID_PARAMS.getCode(),
                            this.cmdName()
                                    + &quot;: Unable to delete this virtual port in the virtual network : &quot;
                                    + e.getMessage()), 0);
        } catch (final InvalidPortException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Invalid port : &quot; + e.getMessage()), 0);
        } catch (final InvalidTenantIdException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Invalid tenant id : &quot; + e.getMessage()), 0);
        } catch (final InvalidDPIDException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Invalid virtual dpid : &quot; + e.getMessage()), 0);
        } catch (final NetworkMappingException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: &quot; + e.getMessage()), 0);
        }
        return resp;
    }


    @Override
    public JSONRPC2ParamsType getType() {
        return JSONRPC2ParamsType.OBJECT;
    }

}</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>net/onrc/openvirtex/db/DBManager.java</td><td>458</td></tr><tr class="a"><td>net/onrc/openvirtex/db/DBManager.java</td><td>544</td></tr><tr class="b"><td colspan='2'><div><pre>                    .get(TenantHandler.PATH);
            for (Map&lt;String, Object&gt; hop : path) {
                // Fetch link
                Long srcDpid = (Long) hop.get(TenantHandler.SRC_DPID);
                Short srcPort = ((Integer) hop.get(TenantHandler.SRC_PORT))
                        .shortValue();
                Long dstDpid = (Long) hop.get(TenantHandler.DST_DPID);
                Short dstPort = ((Integer) hop.get(TenantHandler.DST_PORT))
                        .shortValue();
                DPIDandPortPair dpp = new DPIDandPortPair(new DPIDandPort(
                        srcDpid, srcPort), new DPIDandPort(dstDpid, dstPort));
                // Register link in current manager
                mngr.registerLink(dpp);
                // Update list of managers that wait for this link
                List&lt;OVXNetworkManager&gt; mngrs = this.linkToMngr.get(dpp);
                if (mngrs == null) {
                    this.linkToMngr
                            .put(dpp, new ArrayList&lt;OVXNetworkManager&gt;());
                }
                this.linkToMngr.get(dpp).add(mngr);

                // Register src/dst switches of this link
                mngr.registerSwitch(srcDpid);
                mngr.registerSwitch(dstDpid);
                // Update list of managers that wait for these switches
                mngrs = this.dpidToMngr.get(srcDpid);
                if (mngrs == null) {
                    this.dpidToMngr.put(srcDpid,
                            new ArrayList&lt;OVXNetworkManager&gt;());
                }
                this.dpidToMngr.get(srcDpid).add(mngr);
                mngrs = this.dpidToMngr.get(dstDpid);
                if (mngrs == null) {
                    this.dpidToMngr.put(dstDpid,
                            new ArrayList&lt;OVXNetworkManager&gt;());
                }
                this.dpidToMngr.get(dstDpid).add(mngr);
            }
        }
    }</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/tenant/StartOVXSwitch.java</td><td>62</td></tr><tr class="a"><td>net/onrc/openvirtex/api/service/handlers/tenant/StopOVXSwitch.java</td><td>61</td></tr><tr class="b"><td colspan='2'><div><pre>            this.log.info(&quot;Start virtual switch {} in virtual network {}&quot;,
                    dpid, virtualNetwork.getTenantId());
            OVXSwitch ovxSwitch = virtualNetwork.getSwitch(dpid.longValue());
            Map&lt;String, Object&gt; reply = new HashMap&lt;String, Object&gt;(
                    ovxSwitch.getDBObject());
            reply.put(TenantHandler.TENANT, ovxSwitch.getTenantId());
            resp = new JSONRPC2Response(reply, 0);

        } catch (final MissingRequiredField e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Unable to create virtual network : &quot;
                            + e.getMessage()), 0);
        } catch (final InvalidDPIDException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Invalid DPID : &quot; + e.getMessage()), 0);
        } catch (final InvalidTenantIdException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Invalid tenant id : &quot; + e.getMessage()), 0);
        } catch (final NetworkMappingException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: &quot; + e.getMessage()), 0);
        }
        return resp;

    }

    @Override
    public JSONRPC2ParamsType getType() {
        return JSONRPC2ParamsType.OBJECT;
    }
}</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/MonitoringHandler.java</td><td>76</td></tr><tr class="a"><td>net/onrc/openvirtex/api/service/handlers/TenantHandler.java</td><td>178</td></tr><tr class="b"><td colspan='2'><div><pre>            this.put(&quot;getVirtualAddressMapping&quot;, new GetVirtualAddressMapping());
        }
    };

    @Override
    public String[] handledRequests() {
        return this.handlers.keySet().toArray(new String[] {});
    }


    @Override
    @SuppressWarnings({ &quot;rawtypes&quot;, &quot;unchecked&quot; })
    public JSONRPC2Response process(final JSONRPC2Request req,
            final MessageContext ctxt) {

        final ApiHandler m = this.handlers.get(req.getMethod());
        if (m != null) {

            if (m.getType() != JSONRPC2ParamsType.NO_PARAMS
                    &amp;&amp; m.getType() != req.getParamsType()) {
                return new JSONRPC2Response(new JSONRPC2Error(
                        JSONRPC2Error.INVALID_PARAMS.getCode(), req.getMethod()
                                + &quot; requires: &quot; + m.getType() + &quot;; got: &quot;
                                + req.getParamsType()), req.getID());
            }

            switch (m.getType()) {
            case NO_PARAMS:
                return m.process(null);
            case ARRAY:
                return m.process(req.getPositionalParams());
            case OBJECT:
                return m.process(req.getNamedParams());
            default:
                break;
            }
        }

        return new JSONRPC2Response(JSONRPC2Error.METHOD_NOT_FOUND, req.getID());
    }

}</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>net/onrc/openvirtex/messages/OVXPacketOut.java</td><td>122</td></tr><tr class="a"><td>net/onrc/openvirtex/messages/OVXPacketOut.java</td><td>158</td></tr><tr class="b"><td colspan='2'><div><pre>            this.setInPort(inport.getPhysicalPortNumber());
        }
        //this.prependRewriteActions(sw);
        if (GlobalConfig.bnvTagType == TAG.TOS) {
            TenantMapperTos.prependRewriteActions(sw.getTenantId(), match, approvedActions);
        } else if (GlobalConfig.bnvTagType == TAG.VLAN) {
            TenantMapperVlan.prependRewriteActions(sw.getTenantId(), match, approvedActions);
        } else if (GlobalConfig.bnvTagType == TAG.NOTAG){
            /* Do Nothing */
        }
        this.setActions(this.approvedActions);
        this.setActionsLength((short) 0);
        this.setLengthU(OVXPacketOut.MINIMUM_LENGTH + this.packetData.length);
        for (final OFAction act : this.approvedActions) {
            this.setLengthU(this.getLengthU() + act.getLengthU());
            this.setActionsLength((short) (this.getActionsLength() + act
                    .getLength()));
        }

        // TODO: Beacon sometimes send msg with inPort == controller, check with
        // Ayaka if it's ok
        if (U16.f(this.getInPort()) &lt; U16.f(OFPort.OFPP_MAX.getValue())) {
            OVXMessageUtil.translateXid(this, inport);
        }
        this.log.debug(&quot;Sending packet-out to sw {}: {}&quot;, sw.getName(), this);</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/tenant/ConnectOVXLink.java</td><td>118</td></tr><tr class="a"><td>net/onrc/openvirtex/api/service/handlers/tenant/SetOVXLinkPath.java</td><td>83</td></tr><tr class="b"><td colspan='2'><div><pre>                Map&lt;String, Object&gt; reply = new HashMap&lt;String, Object&gt;(
                        virtualLink.getDBObject());
                reply.put(TenantHandler.TENANT, virtualLink.getTenantId());
                resp = new JSONRPC2Response(reply, 0);
            }
        } catch (final MissingRequiredField e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Unable to create virtual link : &quot;
                            + e.getMessage()), 0);
        } catch (final VirtualLinkException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Invalid virtual link : &quot; + e.getMessage()), 0);
        } catch (final InvalidTenantIdException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Invalid tenant id : &quot; + e.getMessage()), 0);
        } catch (final IndexOutOfBoundException e) {
            resp = new JSONRPC2Response(
                    new JSONRPC2Error(
                            JSONRPC2Error.INVALID_PARAMS.getCode(),
                            this.cmdName()
                                    + &quot;: Impossible to create the virtual link, too many links in this virtual network : &quot;</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/tenant/RemoveOVXPort.java</td><td>75</td></tr><tr class="a"><td>net/onrc/openvirtex/api/service/handlers/tenant/StartOVXPort.java</td><td>87</td></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/tenant/StopOVXPort.java</td><td>87</td></tr><tr class="a"><td colspan='2'><div><pre>                            + e.getMessage()), 0);
        } catch (final InvalidPortException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Invalid port : &quot; + e.getMessage()), 0);
        } catch (final InvalidTenantIdException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Invalid tenant id : &quot; + e.getMessage()), 0);
        } catch (final InvalidDPIDException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Invalid virtual dpid : &quot; + e.getMessage()), 0);
        } catch (final NetworkMappingException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: &quot; + e.getMessage()), 0);
        }
        return resp;
    }


    @Override
    public JSONRPC2ParamsType getType() {
        return JSONRPC2ParamsType.OBJECT;
    }

}</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>net/onrc/openvirtex/packet/AbstractSegment.java</td><td>108</td></tr><tr class="b"><td>net/onrc/openvirtex/packet/TCP.java</td><td>228</td></tr><tr class="a"><td colspan='2'><div><pre>        if (this.checksum == 0) {
            bb.rewind();
            int accumulation = 0;

            // compute pseudo header mac
            if (this.parent != null &amp;&amp; this.parent instanceof IPv4) {
                final IPv4 ipv4 = (IPv4) this.parent;
                accumulation += (ipv4.getSourceAddress() &gt;&gt; 16 &amp; 0xffff)
                        + (ipv4.getSourceAddress() &amp; 0xffff);
                accumulation += (ipv4.getDestinationAddress() &gt;&gt; 16 &amp; 0xffff)
                        + (ipv4.getDestinationAddress() &amp; 0xffff);
                accumulation += ipv4.getProtocol() &amp; 0xff;
                accumulation += length &amp; 0xffff;
            }

            for (int i = 0; i &lt; length / 2; ++i) {
                accumulation += 0xffff &amp; bb.getShort();
            }
            // pad to an even number of shorts
            if (length % 2 &gt; 0) {
                accumulation += (bb.get() &amp; 0xff) &lt;&lt; 8;
            }

            accumulation = (accumulation &gt;&gt; 16 &amp; 0xffff)
                    + (accumulation &amp; 0xffff);
            this.checksum = (short) (~accumulation &amp; 0xffff);
            bb.putShort(6, this.checksum);</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>net/onrc/openvirtex/elements/network/LoopNetwork.java</td><td>78</td></tr><tr class="b"><td>net/onrc/openvirtex/elements/network/LoopNetwork.java</td><td>174</td></tr><tr class="a"><td colspan='2'><div><pre>            DPIDandPortPair myPair = addPorts.get(i);
            System.out.println(myNet.dpidMap.toString());

            PhysicalSwitch sSwitch = myNet.getSwitch(myPair.getSrc().getDpid());
            if (sSwitch == null) {
                System.out.println(&quot;sSwitch is null!&quot;);
                continue;
            }
            PhysicalPort sPort = sSwitch.getPort(myPair.getSrc().getPort());
            if (sPort == null) {
                System.out.println(&quot;sPort is null!&quot;);
                continue;
            }
            PhysicalSwitch dSwitch = myNet.getSwitch(myPair.getDst().getDpid());
            if (sSwitch == null) {
                System.out.println(&quot;dSwitch is null!&quot;);
                continue;
            }
            PhysicalPort dPort = dSwitch.getPort(myPair.getDst().getPort());
            if (dPort == null ) {
                System.out.println(&quot;dPort is null!&quot;);
                continue;
            }
            myNet.createLink(sPort,dPort);
            myNet.createLink(dPort,sPort);
        }
    }</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>net/onrc/openvirtex/elements/network/LoopNetwork.java</td><td>78</td></tr><tr class="b"><td>net/onrc/openvirtex/elements/network/LoopNetwork.java</td><td>146</td></tr><tr class="a"><td>net/onrc/openvirtex/elements/network/LoopNetwork.java</td><td>174</td></tr><tr class="b"><td colspan='2'><div><pre>            DPIDandPortPair myPair = addPorts.get(i);
            System.out.println(myNet.dpidMap.toString());

            PhysicalSwitch sSwitch = myNet.getSwitch(myPair.getSrc().getDpid());
            if (sSwitch == null) {
                System.out.println(&quot;sSwitch is null!&quot;);
                continue;
            }
            PhysicalPort sPort = sSwitch.getPort(myPair.getSrc().getPort());
            if (sPort == null) {
                System.out.println(&quot;sPort is null!&quot;);
                continue;
            }
            PhysicalSwitch dSwitch = myNet.getSwitch(myPair.getDst().getDpid());
            if (sSwitch == null) {
                System.out.println(&quot;dSwitch is null!&quot;);
                continue;
            }
            PhysicalPort dPort = dSwitch.getPort(myPair.getDst().getPort());
            if (dPort == null ) {
                System.out.println(&quot;dPort is null!&quot;);
                continue;
            }
            myNet.createLink(sPort,dPort);
            myNet.createLink(dPort,sPort);
        }</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/tenant/RemoveOVXPort.java</td><td>39</td></tr><tr class="a"><td>net/onrc/openvirtex/api/service/handlers/tenant/StartOVXPort.java</td><td>41</td></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/tenant/StopOVXPort.java</td><td>41</td></tr><tr class="a"><td colspan='2'><div><pre>    Logger log = LogManager.getLogger(RemoveOVXPort.class.getName());

    @Override
    public JSONRPC2Response process(final Map&lt;String, Object&gt; params) {
        JSONRPC2Response resp = null;

        try {
            final Number tenantId = HandlerUtils.&lt;Number&gt;fetchField(
                    TenantHandler.TENANT, params, true, null);
            final Number dpid = HandlerUtils.&lt;Number&gt;fetchField(
                    TenantHandler.VDPID, params, true, null);
            final Number port = HandlerUtils.&lt;Number&gt;fetchField(
                    TenantHandler.VPORT, params, true, null);

            HandlerUtils.isValidTenantId(tenantId.intValue());
            HandlerUtils
                    .isValidOVXSwitch(tenantId.intValue(), dpid.longValue());
            HandlerUtils.isValidOVXPort(tenantId.intValue(), dpid.longValue(),
                    port.shortValue());

            final OVXMap map = OVXMap.getInstance();
            final OVXNetwork virtualNetwork = map.getVirtualNetwork(tenantId
                    .intValue());

            virtualNetwork.removePort(dpid.longValue(), port.shortValue());</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>net/onrc/openvirtex/api/service/handlers/tenant/RemoveOVXSwitch.java</td><td>71</td></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/tenant/StartOVXSwitch.java</td><td>74</td></tr><tr class="a"><td>net/onrc/openvirtex/api/service/handlers/tenant/StopOVXSwitch.java</td><td>73</td></tr><tr class="b"><td colspan='2'><div><pre>                            + e.getMessage()), 0);
        } catch (final InvalidDPIDException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Invalid DPID : &quot; + e.getMessage()), 0);
        } catch (final InvalidTenantIdException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Invalid tenant id : &quot; + e.getMessage()), 0);
        } catch (final NetworkMappingException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: &quot; + e.getMessage()), 0);
        }

        return resp;
    }

    @Override
    public JSONRPC2ParamsType getType() {
        return JSONRPC2ParamsType.OBJECT;
    }

}</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>net/onrc/openvirtex/api/service/MonitoringService.java</td><td>42</td></tr><tr class="a"><td>net/onrc/openvirtex/api/service/TenantService.java</td><td>42</td></tr><tr class="b"><td colspan='2'><div><pre>        this.dispatcher.register(new MonitoringHandler());
    }

    @Override
    public void handle(final HttpServletRequest request,
            final HttpServletResponse response) {
        JSONRPC2Request json = null;
        JSONRPC2Response jsonResp = null;
        try {
            json = this.parseJSONRequest(request);
            jsonResp = this.dispatcher.process(json, null);
            jsonResp.setID(json.getID());
        } catch (final IOException e) {
            jsonResp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.PARSE_ERROR.getCode(),
                    AbstractService.stack2string(e)), 0);
        } catch (final JSONRPC2ParseException e) {
            jsonResp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.PARSE_ERROR.getCode(),
                    AbstractService.stack2string(e)), 0);
        }
        try {
            this.writeJSONObject(response, jsonResp);
        } catch (final IOException e) {</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/tenant/ConnectHost.java</td><td>93</td></tr><tr class="a"><td>net/onrc/openvirtex/api/service/handlers/tenant/CreateOVXPort.java</td><td>121</td></tr><tr class="b"><td colspan='2'><div><pre>                            + &quot;: Unable to connect host : &quot; + e.getMessage()),
                    0);
        } catch (final InvalidPortException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Invalid port : &quot; + e.getMessage()), 0);
        } catch (final InvalidTenantIdException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Invalid tenant id : &quot; + e.getMessage()), 0);
        } catch (final IndexOutOfBoundException e) {
            resp = new JSONRPC2Response(
                    new JSONRPC2Error(
                            JSONRPC2Error.INVALID_PARAMS.getCode(),
                            this.cmdName()
                                    + &quot;: Impossible to create the virtual port, too many ports on this virtual switch : &quot;
                                    + e.getMessage()), 0);
        } catch (final NetworkMappingException e) {</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/tenant/AddController.java</td><td>87</td></tr><tr class="a"><td>net/onrc/openvirtex/api/service/handlers/tenant/CreateOVXSwitch.java</td><td>105</td></tr><tr class="b"><td colspan='2'><div><pre>                                    + e.getMessage()), 0);
        } catch (final InvalidDPIDException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Invalid DPID : &quot; + e.getMessage()), 0);
        } catch (final InvalidTenantIdException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Invalid tenant id : &quot; + e.getMessage()), 0);
        } catch (final NetworkMappingException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: &quot; + e.getMessage()), 0);
        } catch (ControllerUnavailableException e) {</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/tenant/AddController.java</td><td>87</td></tr><tr class="a"><td>net/onrc/openvirtex/api/service/handlers/tenant/CreateOVXSwitch.java</td><td>105</td></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/tenant/RemoveOVXSwitch.java</td><td>71</td></tr><tr class="a"><td>net/onrc/openvirtex/api/service/handlers/tenant/StartOVXSwitch.java</td><td>74</td></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/tenant/StopOVXSwitch.java</td><td>73</td></tr><tr class="a"><td colspan='2'><div><pre>                                    + e.getMessage()), 0);
        } catch (final InvalidDPIDException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Invalid DPID : &quot; + e.getMessage()), 0);
        } catch (final InvalidTenantIdException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Invalid tenant id : &quot; + e.getMessage()), 0);
        } catch (final NetworkMappingException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: &quot; + e.getMessage()), 0);
        } catch (ControllerUnavailableException e) {</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>net/onrc/openvirtex/messages/statistics/OVXAggregateStatisticsRequest.java</td><td>88</td></tr><tr class="b"><td>net/onrc/openvirtex/messages/statistics/OVXFlowStatisticsRequest.java</td><td>102</td></tr><tr class="a"><td colspan='2'><div><pre>    }

    private List&lt;PhysicalSwitch&gt; getPhysicalSwitches(OVXSwitch sw) {
        if (sw instanceof OVXSingleSwitch) {
            try {
                return sw.getMap().getPhysicalSwitches(sw);
            } catch (SwitchMappingException e) {
                log.debug(&quot;OVXSwitch {} does not map to any physical switches&quot;,
                        sw.getSwitchName());
                return new LinkedList&lt;&gt;();
            }
        }
        LinkedList&lt;PhysicalSwitch&gt; sws = new LinkedList&lt;PhysicalSwitch&gt;();
        for (OVXPort p : sw.getPorts().values()) {
            if (!sws.contains(p.getPhysicalPort().getParentSwitch())) {
                sws.add(p.getPhysicalPort().getParentSwitch());
            }
        }
        return sws;
    }

}</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>net/onrc/openvirtex/api/service/handlers/tenant/RemoveOVXSwitch.java</td><td>39</td></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/tenant/StartOVXSwitch.java</td><td>40</td></tr><tr class="a"><td>net/onrc/openvirtex/api/service/handlers/tenant/StopOVXSwitch.java</td><td>40</td></tr><tr class="b"><td colspan='2'><div><pre>    Logger log = LogManager.getLogger(RemoveOVXSwitch.class.getName());


    @Override
    public JSONRPC2Response process(final Map&lt;String, Object&gt; params) {
        JSONRPC2Response resp = null;

        try {
            final Number tenantId = HandlerUtils.&lt;Number&gt;fetchField(
                    TenantHandler.TENANT, params, true, null);
            final Number dpid = HandlerUtils.&lt;Number&gt;fetchField(
                    TenantHandler.VDPID, params, true, null);


            HandlerUtils.isValidTenantId(tenantId.intValue());
            HandlerUtils
                    .isValidOVXSwitch(tenantId.intValue(), dpid.longValue());

            final OVXMap map = OVXMap.getInstance();
            final OVXNetwork virtualNetwork = map.getVirtualNetwork(tenantId
                    .intValue());
            virtualNetwork.removeSwitch(dpid.longValue());</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>net/onrc/openvirtex/linkdiscovery/SwitchDiscoveryManager.java</td><td>213</td></tr><tr class="a"><td>net/onrc/openvirtex/linkdiscovery/SwitchDiscoveryManager.java</td><td>247</td></tr><tr class="b"><td colspan='2'><div><pre>    private OFPacketOut createLLDPPacketOut(final PhysicalPort port)
            throws PortMappingException {
        if (port == null) {
            throw new PortMappingException(
                    &quot;Cannot send LLDP associated with a nonexistent port&quot;);
        }
        final OFPacketOut packetOut = (OFPacketOut) this.ovxMessageFactory
                .getMessage(OFType.PACKET_OUT);
        packetOut.setBufferId(OFPacketOut.BUFFER_ID_NONE);
        final List&lt;OFAction&gt; actionsList = new LinkedList&lt;OFAction&gt;();
        final OFActionOutput out = (OFActionOutput) this.ovxMessageFactory
                .getAction(OFActionType.OUTPUT);
        out.setPort(port.getPortNumber());
        actionsList.add(out);
        packetOut.setActions(actionsList);
        final short alen = SwitchDiscoveryManager.countActionsLen(actionsList);
        this.lldpPacket.setPort(port);
        this.ethPacket.setSourceMACAddress(port.getHardwareAddress());</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>net/onrc/openvirtex/elements/Mapper/TenantMapperVlan.java</td><td>135</td></tr><tr class="a"><td>net/onrc/openvirtex/elements/Mapper/TenantMapperVlan.java</td><td>185</td></tr><tr class="b"><td colspan='2'><div><pre>        System.out.println(&quot;Inside PrependRewriteActions .. Approved Actions so far :&quot;+ approvedActions.toString());
        for (int i=0;i&lt; approvedActions.size();i++) {
            OFAction action = approvedActions.get(i);
            if (action.getType() == OFActionType.SET_VLAN_ID) {
                OVXActionVirtualLanIdentifier existingVlan = (OVXActionVirtualLanIdentifier) action;
                vlan = existingVlan.getVirtualLanIdentifier();
                index = i;
                System.out.println(&quot;Found Vlan action at index &quot;+ i+ &quot; with vlan tag &quot;+ vlan);
                break;
            }
            if (action.getType() == OFActionType.STRIP_VLAN) {
                vlan = 1;
                stripindex = i;
                System.out.println(&quot;Found Strip Vlan at index &quot;+ i);
            }
        }
        if (index &gt; -1) {</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/tenant/ConnectOVXRoute.java</td><td>134</td></tr><tr class="a"><td>net/onrc/openvirtex/api/service/handlers/tenant/SetOVXLinkPath.java</td><td>116</td></tr><tr class="b"><td colspan='2'><div><pre>                                    + e.getMessage()), 0);
        } catch (final NetworkMappingException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: &quot; + e.getMessage()), 0);
        } catch (final InvalidPriorityException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: &quot; + e.getMessage()), 0);
        }
        return resp;
    }


    @Override
    public JSONRPC2ParamsType getType() {
        return JSONRPC2ParamsType.OBJECT;
    }
}</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/tenant/DisconnectOVXLink.java</td><td>77</td></tr><tr class="a"><td>net/onrc/openvirtex/api/service/handlers/tenant/RemoveOVXNetwork.java</td><td>79</td></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/tenant/RemoveOVXSwitch.java</td><td>75</td></tr><tr class="a"><td>net/onrc/openvirtex/api/service/handlers/tenant/StartOVXNetwork.java</td><td>67</td></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/tenant/StartOVXSwitch.java</td><td>78</td></tr><tr class="a"><td>net/onrc/openvirtex/api/service/handlers/tenant/StopOVXNetwork.java</td><td>68</td></tr><tr class="b"><td>net/onrc/openvirtex/api/service/handlers/tenant/StopOVXSwitch.java</td><td>77</td></tr><tr class="a"><td colspan='2'><div><pre>                            + &quot;: Invalid virtual link : &quot; + e.getMessage()), 0);
        } catch (final InvalidTenantIdException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: Invalid tenant id : &quot; + e.getMessage()), 0);
        } catch (final NetworkMappingException e) {
            resp = new JSONRPC2Response(new JSONRPC2Error(
                    JSONRPC2Error.INVALID_PARAMS.getCode(), this.cmdName()
                            + &quot;: &quot; + e.getMessage()), 0);
        }
        return resp;
    }

    @Override
    public JSONRPC2ParamsType getType() {
        return JSONRPC2ParamsType.OBJECT;
    }


}</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>net/onrc/openvirtex/packet/TCP.java</td><td>224</td></tr><tr class="b"><td>net/onrc/openvirtex/packet/UDP.java</td><td>156</td></tr><tr class="a"><td colspan='2'><div><pre>            ((IPv4) this.parent).setProtocol(IPv4.PROTOCOL_TCP);
        }

        // compute checksum if needed
        if (this.checksum == 0) {
            bb.rewind();
            int accumulation = 0;

            // compute pseudo header mac
            if (this.parent != null &amp;&amp; this.parent instanceof IPv4) {
                final IPv4 ipv4 = (IPv4) this.parent;
                accumulation += (ipv4.getSourceAddress() &gt;&gt; 16 &amp; 0xffff)
                        + (ipv4.getSourceAddress() &amp; 0xffff);
                accumulation += (ipv4.getDestinationAddress() &gt;&gt; 16 &amp; 0xffff)
                        + (ipv4.getDestinationAddress() &amp; 0xffff);
                accumulation += ipv4.getProtocol() &amp; 0xff;
                accumulation += length &amp; 0xffff;</pre></div></td></tr></table><table align="center" border="0" class="bodyTable"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>net/onrc/openvirtex/packet/AbstractSegment.java</td><td>108</td></tr><tr class="b"><td>net/onrc/openvirtex/packet/UDP.java</td><td>160</td></tr><tr class="a"><td colspan='2'><div><pre>        if (this.checksum == 0) {
            bb.rewind();
            int accumulation = 0;

            // compute pseudo header mac
            if (this.parent != null &amp;&amp; this.parent instanceof IPv4) {
                final IPv4 ipv4 = (IPv4) this.parent;
                accumulation += (ipv4.getSourceAddress() &gt;&gt; 16 &amp; 0xffff)
                        + (ipv4.getSourceAddress() &amp; 0xffff);
                accumulation += (ipv4.getDestinationAddress() &gt;&gt; 16 &amp; 0xffff)
                        + (ipv4.getDestinationAddress() &amp; 0xffff);
                accumulation += ipv4.getProtocol() &amp; 0xff;
                accumulation += length &amp; 0xffff;</pre></div></td></tr></table></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;  All Rights Reserved.      
            
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
